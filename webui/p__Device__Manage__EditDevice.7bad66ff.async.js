(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"62ka":function(e,t,l){"use strict";var a=l("g09b"),i=l("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,l("IzEo");var u=a(l("bx4M"));l("+L6B");var n=a(l("2/Rp")),r=a(l("jehZ"));l("7Kak");var o=a(l("9yH6"));l("8dk+");var s=a(l("eZ87"));l("OaEy");var d=a(l("2fM7"));l("5NDa");var m=a(l("5rEg"));l("Pwec");var f=a(l("CtXQ"));l("Xi6J");var c=a(l("kl6h"));l("miYZ");var h=a(l("tsqr")),p=a(l("2Taf")),v=a(l("vZ4D")),g=a(l("l4Ni")),E=a(l("ujKo")),V=a(l("MhPg"));l("y8nQ");var y,S,b,k,T=a(l("Vl3Y")),H=i(l("q1tI")),A=a(l("3a4m")),M=l("MuoO"),I=a(l("wd/R")),D=(y=T.default.create(),S=(0,M.connect)(function(e){var t=e.device,l=e.loading;return{device:t,loading:l.models.device}}),y(b=S((k=function(e){function t(){var e,l;(0,p.default)(this,t);for(var a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return l=(0,g.default)(this,(e=(0,E.default)(t)).call.apply(e,[this].concat(i))),l.state={lightSenseVisual:"none",timerVisual:"none",autoVisual:"none",modeVisual:"block",lightMode:[],autoStartTime:"",autoEndTime:"",explosionVisual:""},l.handleSubmit=function(e){e.preventDefault(),l.props.form.validateFields(function(e,t){null==e&&l.submit(t)})},l.submit=function(e){var t=l.props.dispatch,a=[],i=[],u=[],n=!1;if(e.keys.forEach(function(t){var l=e["AutoStartTime".concat(t)],r=e["AutoEndTime".concat(t)];if(null!==l&&null!==r){var o={AutoStartTime:(0,I.default)(l,"HH:mm").format("HH:mm"),AutoEndTime:(0,I.default)(r,"HH:mm").format("HH:mm")};i.push(e["AutoStartTime".concat(t)].format("HH:mm")),u.push(e["AutoEndTime".concat(t)].format("HH:mm")),a.push(o),delete e["AutoStartTime".concat(t)],delete e["AutoEndTime".concat(t)]}else n=!0}),n)h.default.error("\u65f6\u95f4\u6bb5\u4e0d\u80fd\u4e3a\u7a7a");else{delete e.keys,e.Timer=a,i=i.sort(),u=u.sort();for(var r=u.reverse(),o=0,s=[],d=0;d<a.length;d++){var m=a[d];if(m.AutoEndTime<m.AutoStartTime){if(m.AutoEndTime>i[0])return void h.default.error("\u65f6\u95f4\u6bb5\u91cd\u590d\uff0c\u5f00\u59cb\u8303\u56f4\uff1a"+m.AutoStartTime+" - "+m.AutoEndTime);if(m.AutoStartTime<r[0])return void h.default.error("\u65f6\u95f4\u6bb5\u91cd\u590d\uff0c\u5f00\u59cb\u8303\u56f4\uff1a"+m.AutoStartTime+" - "+m.AutoEndTime);o++}else s.push(m)}if(o>1)h.default.error("\u65f6\u95f4\u6bb5\u91cd\u590d,\u591a\u4e2a\u65f6\u95f4\u6bb5\u8de8\u8d8a\u51cc\u6668");else{for(var f=[],c=[],p=0;p<s.length;p++)f.push(s[p].AutoStartTime),c.push(s[p].AutoEndTime);for(var v=f.sort(),g=c.sort(),E=1;E<s.length;E++)if(v[E]<g[E-1])return void h.default.error("\u65f6\u95f4\u6bb5\u91cd\u590d, \u5f00\u59cb\u65f6\u95f4\u662f\uff1a",v[E]);t({type:"device/editAddedDevice",payload:e}).then(function(e){e&&l.handleClose()})}}},l.handleClose=function(){A.default.push("/device/manage")},l.lightMode=function(e){var t=l.props.form.setFieldsValue;t({LightMode:e}),3!==e&&0!==e?(1===e?l.setState({lightSenseVisual:"block",lightMode:e}):l.setState({lightSenseVisual:"none",lightMode:e}),2===e?l.setState({timerVisual:"block",lightMode:e}):l.setState({timerVisual:"none",lightMode:e})):l.setState({lightSenseVisual:"none",timerVisual:"none",lightMode:e})},l.lightModeChange=function(e){var t=e.target.value;l.lightMode(t)},l.onSelect=function(e){1===e?(l.setState({autoVisual:"inline",explosionVisual:"none",modeVisual:"inline"}),l.lightMode(3)):3===e?(l.setState({autoVisual:"none",explosionVisual:"block",modeVisual:"none"}),l.lightMode(1)):(l.setState({autoVisual:"none",explosionVisual:"none",modeVisual:"block"}),l.lightMode(4))},l.remove=function(e){var t=l.props.form,a=t.getFieldValue("keys");1!==a.length&&t.setFieldsValue({keys:a.filter(function(t){return t!==e})})},l.add=function(){var e=l.props.form,t=e.getFieldValue("keys");if(t.length>15)h.default.info("\u65f6\u95f4\u6bb5\u4e0d\u80fd\u8d85\u8fc716\u4e2a");else{var a=t.concat(t.length);e.setFieldsValue({keys:a})}},l}return(0,V.default)(t,e),(0,v.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.state,t=e.LightMode,l=e.DeviceAttribute,a=e.AutoStartTime,i=e.AutoEndTime;1===l?this.setState({autoVisual:"inline",explosionVisual:"none",modeVisual:"inline"}):3===l?this.setState({autoVisual:"none",explosionVisual:"block",modeVisual:"none",lightMode:4}):this.setState({autoVisual:"none",explosionVisual:"none",modeVisual:"inline"}),0===t?this.setState({lightMode:"3"}):1===t?this.setState({lightMode:t,lightSenseVisual:"block",timerVisual:"none"}):2===t?this.setState({lightMode:t,lightSenseVisual:"none",timerVisual:"block",autoStartTime:a,autoEndTime:i}):this.setState({lightMode:t,timerVisual:"none",lightSenseVisual:"none",autoStartTime:a,autoEndTime:i})}},{key:"render",value:function(){var e=this,t=this.props.form,l=t.getFieldDecorator,a=t.getFieldValue,i=this.state,h=i.lightSenseVisual,p=i.timerVisual,v=i.lightMode,g=i.autoStartTime,E=i.autoEndTime,V=i.autoVisual,y=i.explosionVisual,S=i.modeVisual,b=this.props.location.state,k=b.SerialNumber,A=b.DeviceName,M=b.DeviceIp,D=b.DevicePort,C=b.DeviceLightThreshold,w=b.DeviceBrightness,x=b.DeviceAttribute,q=b.FlashDuration,P={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6"},F={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},N=[{key:1,value:"\u5e38\u4eae"},{key:2,value:"\u9891\u95ea"},{key:3,value:"\u7206\u95ea"}],L={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20"},O={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},Z=[];if(""!==g)for(var j=g.split(",").length,B=0;B<j;B++)Z[B]=B;else Z[0]=0;l("keys",{initialValue:Z});var J=a("keys"),X=J.map(function(t,a){var i="AutoStartTime".concat(t),u="AutoEndTime".concat(t),n=(0,I.default)(g.split(",")[a],"HH:mm"),r=(0,I.default)(E.split(",")[a],"HH:mm");return n.isValid()||(n=(0,I.default)("18:00","HH:mm")),r.isValid()||(r=(0,I.default)("07:00","HH:mm")),H.default.createElement("div",{key:a+1},H.default.createElement("div",{style:{display:"inline"}},"\u5f00\u59cb\u65f6\u95f4\uff1a",l(i,{initialValue:n||(0,I.default)("18:00","HH:mm"),rules:[{required:!1,message:"\u5f00\u59cb\u65f6\u95f4"}]})(H.default.createElement(c.default,{minuteStep:1,format:"HH:mm"})),"\xa0\xa0-\xa0 \u7ed3\u675f\u65f6\u95f4\uff1a",l(u,{initialValue:r||(0,I.default)("07:00","HH:mm"),rules:[{required:!1,message:"\u7ed3\u675f\u65f6\u95f4"}]})(H.default.createElement(c.default,{minuteStep:1,format:"HH:mm"}))),"\xa0\xa0",J.length>1?H.default.createElement(f.default,{type:"minus-circle-o",onClick:function(){return e.remove(t)}}):null)});return H.default.createElement(u.default,{title:"\u4fee\u6539\u8bbe\u5907\u53c2\u6570"},H.default.createElement(T.default,{labelCol:{span:4},wrapperCol:{span:16},onSubmit:this.handleSubmit},H.default.createElement(T.default.Item,{label:"\u8bbe\u5907\u5e8f\u5217\u53f7"},l("SerialNumber",{initialValue:k,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8bbe\u5907\u53f7"}]})(H.default.createElement(m.default,{disabled:!0}))),H.default.createElement(T.default.Item,{label:"\u8bbe\u5907\u540d\u79f0"},l("DeviceName",{initialValue:A,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8bbe\u5907\u540d\u79f0"}]})(H.default.createElement(m.default,null))),H.default.createElement(T.default.Item,{label:"IP\u5730\u5740"},l("DeviceIp",{initialValue:M,rules:[{required:!0,message:"\u8bf7\u8f93\u5165IP\u5730\u5740"}]})(H.default.createElement(m.default,{disabled:!0}))),H.default.createElement(T.default.Item,{label:"\u670d\u52a1\u7aef\u53e3"},l("DevicePort",{initialValue:D,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u670d\u52a1\u7aef\u53e3"}]})(H.default.createElement(m.default,{disabled:!0}))),H.default.createElement(T.default.Item,{label:"\u5c5e\u6027"},l("DeviceAttribute",{initialValue:x})(H.default.createElement(d.default,{style:{width:"100%"},optionFilterProp:"children",onSelect:this.onSelect,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},N.map(function(e){return H.default.createElement(d.default.Option,{key:e.key,value:e.key},e.value,H.default.createElement("span",{style:{color:"#cccccc"}},"-(\u7f16\u7801\uff1a",e.key,")"))})))),H.default.createElement("div",{style:{display:V}},H.default.createElement(T.default.Item,{label:"\u4eae\u5ea6"},l("DeviceBrightness",{initialValue:w,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u706f\u4eae\u5ea6"}]})(H.default.createElement(s.default,{max:20,min:1,marks:L,step:null})))),H.default.createElement("div",{style:{display:y}},H.default.createElement(T.default.Item,{label:"\u7206\u95ea\u65f6\u95f4"},l("FlashDuration",{initialValue:q,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u706f\u4eae\u5ea6"}]})(H.default.createElement(s.default,{max:10,min:1,marks:F,step:null})))),H.default.createElement("div",{style:{display:S}},H.default.createElement(T.default.Item,{label:"\u8865\u5149\u6a21\u5f0f"},l("LightMode",{initialValue:v})(H.default.createElement(o.default.Group,{onChange:this.lightModeChange},H.default.createElement(o.default,{value:1},"\u81ea\u52a8\u68c0\u6d4b\u4eae\u5ea6\u63a7\u5236\u8865\u5149\u706f"),H.default.createElement(o.default,{value:2},"\u6309\u65f6\u95f4\u542f\u7528\u8865\u5149\u706f"),H.default.createElement(o.default,{value:3,style:{display:V}},"\u5168\u5929\u5e38\u4eae"),H.default.createElement(o.default,{value:4,style:{display:"none"===V?"inline":"none"}},"\u5173\u95ed\u81ea\u52a8\u8865\u5149")))),H.default.createElement(T.default.Item,{style:{display:h},label:"\u5149\u654f\u9600\u503c"},l("DeviceLightThreshold",{initialValue:C,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5149\u654f\u9600\u503c"}]})(H.default.createElement(s.default,{max:6,min:1,marks:P,step:null}))),H.default.createElement("div",{style:{display:p}},H.default.createElement(T.default.Item,(0,r.default)({},O,{label:"\u5b9a\u65f6\u5f00\u542f\u65f6\u95f4\u8303\u56f4",required:!1}),X),H.default.createElement(T.default.Item,{wrapperCol:{span:12,offset:4}},H.default.createElement(n.default,{type:"dashed",onClick:this.add},H.default.createElement(f.default,{type:"plus"})," \u6dfb\u52a0\u65f6\u6bb5")))),H.default.createElement(T.default.Item,{label:"\u8bbe\u5907PIN\u7801"},l("Pin",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8bbe\u5907PIN\u7801\uff0c\u5982\u5fd8\u8bb0\u8bbe\u5907PIN\u7801\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458"}]})(H.default.createElement(m.default.Password,null))),H.default.createElement(T.default.Item,{wrapperCol:{span:12,offset:5}},H.default.createElement(n.default,{onClick:this.handleSubmit,type:"primary",icon:"check-circle",htmlType:"submit"},"\u4fdd\u5b58"),"\xa0\xa0\xa0\xa0",H.default.createElement(n.default,{onClick:this.handleClose,type:"danger",icon:"close-circle",htmlType:"submit"},"\u5173\u95ed"))))}}]),t}(H.Component),b=k))||b)||b),C=D;t.default=C}}]);