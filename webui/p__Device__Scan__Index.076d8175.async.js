(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{NClA:function(e,t,a){"use strict";var n=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var c=n(a("wCAj"));a("IzEo");var l=n(a("bx4M"));a("14J3");var d=n(a("BMrR"));a("BoS7");var s=n(a("Sdc0"));a("jCWc");var r=n(a("kPKH"));a("aHsQ");var u=n(a("sGsY")),o=n(a("eHn4"));a("+L6B");var f,h,v,p=n(a("2/Rp")),m=n(a("2Taf")),g=n(a("vZ4D")),w=n(a("l4Ni")),b=n(a("ujKo")),y=n(a("MhPg")),L=i(a("q1tI")),k=a("MuoO"),C=n(a("3a4m")),I=n(a("Wa4K")),E=(f=(0,k.connect)(function(e){var t=e.device,a=e.loading;return{device:t,loading:a.models.device,batchAddLoading:a.effects["device/batchAddDevice"]}}),f((v=function(e){function t(){var e,a;(0,m.default)(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return a=(0,w.default)(this,(e=(0,b.default)(t)).call.apply(e,[this].concat(i))),a.state={scanList:[],showList:[],switchChecked:!0,timer:"",selectedRows:[]},a.columns=[{title:"\u5e8f\u53f7",width:50,align:"center",dataIndex:"id",render:function(e,t,a){return a+1}},{title:"\u5e8f\u5217\u53f7",dataIndex:"SerialNumber",align:"center"},{title:"\u8bbe\u5907IP",dataIndex:"DeviceIp",align:"center"},{title:"\u7aef\u53e3",dataIndex:"DevicePort",align:"right"},{title:"MAC\u5730\u5740",dataIndex:"MacAddr",align:"center"},{title:"\u4e3b\u63a7\u7248\u672c",dataIndex:"FirmwareVersion",align:"center"},{title:"\u63a9\u7801",dataIndex:"Mask",align:"center"},{title:"\u7f51\u5173",dataIndex:"GatewayAddr",align:"center"},{title:"\u5df2\u6dfb\u52a0",dataIndex:"IsAdded",align:"center",render:function(e,t){return!0===e?"\u662f":"\u5426"}},{title:"\u64cd\u4f5c",width:260,align:"center",render:function(e,t,n){var i;return t.IsAdded?L.default.createElement("div",null,"--"):L.default.createElement("div",null,L.default.createElement(p.default,{onClick:function(){return a.openInstall(t.SerialNumber)},size:"small",ghost:!0,icon:"global",type:"primary",style:{marginLeft:"6px"}},"\u5730\u56fe"),L.default.createElement(p.default,(i={style:{display:function(){return t.enable?"none":"block"}},onClick:function(){return a.add(t)},icon:"plus"},(0,o.default)(i,"style",{marginLeft:"".concat(6,"px")}),(0,o.default)(i,"size","small"),(0,o.default)(i,"ghost",!0),(0,o.default)(i,"type","primary"),i),"\u6dfb\u52a0"),L.default.createElement(p.default,{onClick:function(){return a.edit(t)},size:"small",ghost:!0,icon:"edit",type:"primary",style:{marginLeft:"".concat(6,"px")}},"\u7f16\u8f91"))}}],a.getScanDeviceList=function(){var e=a.props,t=e.dispatch,n=e.device;t({type:"device/fetch"}).then(function(){a.setState({scanList:n.scanDeviceList,showList:n.scanDeviceList,switchChecked:!0})})},a.add=function(e){C.default.push({pathname:"/device/scan/add",state:e})},a.edit=function(e){C.default.push({pathname:"/device/scan/edit",state:e})},a.onChange=function(e){var t=a.state.scanList;if(e)a.setState({showList:t,switchChecked:e});else{var n=[];t.forEach(function(e,t){e.IsAdded||n.push(e)}),a.setState({showList:n,switchChecked:e})}},a.refresh=function(){a.getScanDeviceList()},a.openInstall=function(e){C.default.push({pathname:"/device/install/view",state:{SerialNumber:e,backUrl:"/event/lamp"}})},a.batchAdd=function(){var e=a.state.selectedRows;if(null!==e&&void 0!==e&&e.length>0){var t=a.props,n=t.dispatch,i=t.device;n({type:"device/batchAddDevice",payload:e}).then(function(){n({type:"device/fetch"}).then(function(){a.setState({scanList:i.scanDeviceList,showList:i.scanDeviceList,switchChecked:!0,selectedRows:[]},function(){a.refresh()})})})}},a}return(0,y.default)(t,e),(0,g.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.device;a({type:"device/fetch"}).then(function(){e.setState({scanList:n.scanDeviceList,showList:n.scanDeviceList,switchChecked:!0},function(){e.refresh()})});var i=setInterval(function(){e.refresh()},9e3);this.setState({timer:i})}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.timer)}},{key:"render",value:function(){var e=this,t=this.props,a=t.device,n=t.loading,i=t.batchAddLoading,o=a.scanDeviceList.length,f=a.totalDevices,h=a.scanDeviceList.length;"number"===typeof f&&(h=a.scanDeviceList.length-a.totalDevices,h=h<0?0:h);var v=this.state,m=v.showList,g=v.switchChecked,w={onChange:function(t,a){e.setState({selectedRows:a})},getCheckboxProps:function(e){return{disabled:!0===e.IsAdded}}};return L.default.createElement("div",null,L.default.createElement(l.default,{title:"\u626b\u63cf\u8bbe\u5907"},L.default.createElement(d.default,{gutter:24},L.default.createElement(r.default,{span:8},L.default.createElement(u.default,{title:"\u5728\u7ebf\u8bbe\u5907\u603b\u6570",value:o})),L.default.createElement(r.default,{span:8},L.default.createElement(u.default,{title:"\u5df2\u6dfb\u52a0\u8bbe\u5907\u603b\u6570",value:f})),L.default.createElement(r.default,{span:8},L.default.createElement(u.default,{title:"\u672a\u6dfb\u52a0\u8bbe\u5907\u603b\u6570",value:h}),L.default.createElement("div",{style:{marginTop:16}},L.default.createElement(s.default,{checkedChildren:"\u663e\u793a\u5168\u90e8\u626b\u63cf\u8bbe\u5907",unCheckedChildren:"\u53ea\u663e\u793a\u672a\u6dfb\u52a0\u8bbe\u5907",defaultChecked:!0,checked:g,onChange:this.onChange}))))),L.default.createElement(l.default,null,L.default.createElement("div",{className:I.default.btnGroup},L.default.createElement(p.default,{icon:"plus",onClick:this.batchAdd,loading:i,className:I.default.btnItem,type:"primary",ghost:!0},"\u6dfb\u52a0"),L.default.createElement(p.default,{onClick:this.refresh,className:I.default.btnItem,icon:"sync",type:"primary",ghost:!0},"\u5237\u65b0")),L.default.createElement(c.default,{rowKey:function(e){return e.SerialNumber},bordered:!0,size:"small",loading:n,rowSelection:w,dataSource:m,columns:this.columns})))}}]),t}(L.Component),h=v))||h),D=E;t.default=D},Wa4K:function(e,t,a){e.exports={btnGroup:"antd-pro-web-ui-src-pages-device-scan-index-btnGroup",btnItem:"antd-pro-web-ui-src-pages-device-scan-index-btnItem"}}}]);